import esbuild from 'esbuild';
import {execSync} from "child_process";
import fs from "fs";

execSync('tsc');

esbuild.build({
    bundle: true,
    minify: false,
    platform: 'node',
    format: 'cjs',
    target: 'node16',
    outfile: "dist/index.js",
    entryPoints: ["src/index.ts"],
    loader: {'.txt': 'text'},
}).catch(() => process.exit(1));

const bytes = fs.statSync('./dist/index.js').size;
console.log(`Build completed. Output file size: ${Math.round(bytes / 1024)} KB`);